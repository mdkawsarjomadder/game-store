@page "/editgame"


<PageTitle>New Game</PageTitle>
<h3>New Game</h3>
  
    @if(genres is null)
    {
    <p class=""><em class="">Loading...</em>  </p>
    }
    else
    {
          <div class="row">
     <div class="col-md-4">
     <EditForm Model="@game" FormName="editGame" OnSubmit="HandleSubmmit">
        <div class="mb-3">
            <label for="name" class="form-label">Name:</label>
            <InputText id="name" @bind-value="game.Name" class="form-control"/> 
        </div>
            <div class="mb-3">
            <label for="genre" class="form-label">Genre:</label>
            <InputSelect id="genre" @bind-value="game.GenreId" class="form-select">
              <option value="">Select a Genre!</option>
              @foreach(var genre in genres)
              {
                 <option class="@genre.Id">@genre.Name</option>
              }
            </InputSelect>
            </div>
            <div class="mb-3">
                <label for="price" class="form-label">Price:</label>
                <InputNumber id="price" @bind-value="game.Price" class="form-control"/>
            </div>
            <div class="mb-3">
                <label for="releaseDate" class="form-label">Release Date:</label>
                <InputDate id="releaseDate" @bind-value="game.ReleaseDate" class="form-control"/>
            </div>
          @* button *@
     <button type="button" class="btn btn-primary btn-hover-warning">
    Save Game
</button>
      </EditForm>
     </div>
    </div>
    }

  

@code {
    [SupplyParameterFromForm]
    private  GameDetails game {get; set;} = new()
   {
    Name = string.Empty,
    ReleaseDate = DateOnly.FromDateTime(DateTime.UtcNow)
   };
    private GenresClient genresClient = new();
    private GameClient gameClient = new ();
    private  Genre[]? genres;

    protected override void OnInitialized()
    {
        genres = genresClient.GetGenres();
    }

    private void HandleSubmmit()
    {
        gameClient.AddGame(game);
    }
}
